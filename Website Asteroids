javascript:void function(){(function(){function Asteroids(){function Vector(e,t){"Object"==typeof e%3F(this.x=e.x,this.y=e.y):(this.x=e,this.y=t)}function Line(e,t){this.p1=e,this.p2=t}function updateEnemyIndex(){for(var e,t=0;e=that.enemies[t];t++)removeClass(e,"ASTEROIDSYEAHENEMY");var i=document.body.getElementsByTagName("*");that.enemies=[];for(var s,t=0;s=i[t];t++)-1==indexOf(ignoredTypes,s.tagName.toUpperCase())%26%26"g_vml_"!=s.prefix%26%26hasOnlyTextualChildren(s)%26%26"ASTEROIDSYEAH"!=s.className%26%26s.offsetHeight>0%26%26(s.aSize=size(s),that.enemies.push(s),addClass(s,"ASTEROIDSYEAHENEMY"),s.aAdded||(s.aAdded=!0,that.totalEnemies++))}function radians(e){return.0174532925*e}function random(e,t){return Math.floor(Math.random()*(t+1)+e)}function code(e){var t={up:38,down:40,left:37,right:39,esc:27};return t[e]%3Ft[e]:e.charCodeAt(0)}function boundsCheck(e){e.x>w%3Fe.x=0:e.x<0%26%26(e.x=w),e.y>h%3Fe.y=0:e.y<0%26%26(e.y=h)}function size(e){var t=e,i=0,s=0;do i+=t.offsetLeft||0,s+=t.offsetTop||0,t=t.offsetParent;while(t);return{x:i,y:s,width:e.offsetWidth||10,height:e.offsetHeight||10}}function addEvent(e,t,i){e.addEventListener%3Fe.addEventListener(t,i,!1):e.attachEvent%26%26(e["e"+t+i]=i,e[t+i]=function(){e["e"+t+i](window.event)},e.attachEvent("on"+t,e[t+i]))}function removeEvent(e,t,i){e.removeEventListener%3Fe.removeEventListener(t,i,!1):e.detachEvent%26%26(e.detachEvent("on"+t,e[t+i]),e[t+i]=null,e["e"+t+i]=null)}function applyVisibility(e){for(var t,i=0;t=window.ASTEROIDSPLAYERS[i];i++)t.gameContainer.style.visibility=e}function getElementFromPoint(e,t){applyVisibility("hidden");var i=document.elementFromPoint(e,t);return i%3F(3==i.nodeType%26%26(i=i.parentNode),applyVisibility("visible"),i):(applyVisibility("visible"),!1)}function addParticles(e){for(var t=(new Date).getTime(),i=maxParticles,s=0;i>s;s++)that.particles.push({dir:new Vector(20*Math.random()-10,20*Math.random()-10).normalize(),pos:e.cp(),cameAlive:t})}function setScore(){that.points.innerHTML=10*window.ASTEROIDS.enemiesKilled}function hasOnlyTextualChildren(e){if(e.offsetLeft<-100%26%26e.offsetWidth>0%26%26e.offsetHeight>0)return!1;if(-1!=indexOf(hiddenTypes,e.tagName))return!0;if(0==e.offsetWidth%26%260==e.offsetHeight)return!1;for(var t=0;t<e.childNodes.length;t++)if(-1==indexOf(hiddenTypes,e.childNodes[t].tagName)%26%260!=e.childNodes[t].childNodes.length)return!1;return!0}function indexOf(e,t,i){if(e.indexOf)return e.indexOf(t,i);for(var s=e.length,n=0>i%3FMath.max(0,s+i):i||0;s>n;n++)if(e[n]===t)return n;return-1}function addClass(e,t){-1==e.className.indexOf(t)%26%26(e.className=(e.className+" "+t).replace(/\s+/g," ").replace(/^\s+|\s+$/g,""))}function removeClass(e,t){e.className=e.className.replace(new RegExp("(^|\\s)"+t+"(%3F:\\s|$)"),"$1")}function addStylesheet(e,t){var i=document.createElement("style");i.type="text/css",i.rel="stylesheet",i.id="ASTEROIDSYEAHSTYLES";try{i.innerHTML=e+"{"+t+"}"}catch(s){i.styleSheet.addRule(e,t)}document.getElementsByTagName("head")[0].appendChild(i)}function removeStylesheet(e){var t=document.getElementById(e);t%26%26t.parentNode.removeChild(t)}function destroy(){removeEvent(document,"keydown",eventKeydown),removeEvent(document,"keypress",eventKeypress),removeEvent(document,"keyup",eventKeyup),removeEvent(window,"resize",eventResize),isRunning=!1,removeStylesheet("ASTEROIDSYEAHSTYLES"),removeClass(document.body,"ASTEROIDSYEAH"),this.gameContainer.parentNode.removeChild(this.gameContainer)}window.ASTEROIDS||(window.ASTEROIDS={enemiesKilled:0}),Vector.prototype={cp:function(){return new Vector(this.x,this.y)},mul:function(e){return this.x*=e,this.y*=e,this},mulNew:function(e){return new Vector(this.x*e,this.y*e)},add:function(e){return this.x+=e.x,this.y+=e.y,this},addNew:function(e){return new Vector(this.x+e.x,this.y+e.y)},sub:function(e){return this.x-=e.x,this.y-=e.y,this},subNew:function(e){return new Vector(this.x-e.x,this.y-e.y)},rotate:function(e){var t=this.x,i=this.y;return this.x=t*Math.cos(e)-Math.sin(e)*i,this.y=t*Math.sin(e)+Math.cos(e)*i,this},rotateNew:function(e){return this.cp().rotate(e)},setAngle:function(e){var t=this.len();return this.x=Math.cos(e)*t,this.y=Math.sin(e)*t,this},setAngleNew:function(e){return this.cp().setAngle(e)},setLength:function(e){var t=this.len();return t%3Fthis.mul(e/t):this.x=this.y=e,this},setLengthNew:function(e){return this.cp().setLength(e)},normalize:function(){var e=this.len();return this.x/=e,this.y/=e,this},normalizeNew:function(){return this.cp().normalize()},angle:function(){return Math.atan2(this.y,this.x)},collidesWith:function(e){return this.x>e.x%26%26this.y>e.y%26%26this.x<e.x+e.width%26%26this.y<e.y+e.height},len:function(){var e=Math.sqrt(this.x*this.x+this.y*this.y);return.005>e%26%26e>-.005%3F0:e},is:function(e){return"object"==typeof e%26%26this.x==e.x%26%26this.y==e.y},toString:function(){return"[Vector("+this.x+", "+this.y+") angle: "+this.angle()+", length: "+this.len()+"]"}},Line.prototype={shift:function(e){this.p1.add(e),this.p2.add(e)},intersectsWithRect:function(e){var t=new Vector(e.x,e.y+e.height),i=new Vector(e.x,e.y),s=new Vector(e.x+e.width,e.y+e.height),n=new Vector(e.x+e.width,e.y);return this.p1.x>t.x%26%26this.p1.x<n.x%26%26this.p1.y<t.y%26%26this.p1.y>n.y%26%26this.p2.x>t.x%26%26this.p2.x<n.x%26%26this.p2.y<t.y%26%26this.p2.y>n.y%3F!0:this.intersectsLine(new Line(i,t))%3F!0:this.intersectsLine(new Line(t,s))%3F!0:this.intersectsLine(new Line(i,n))%3F!0:this.intersectsLine(new Line(n,s))%3F!0:!1},intersectsLine:function(e){var t=this.p1,i=this.p2,s=e.p1,n=e.p2,a=(n.y-s.y)*(i.x-t.x)-(n.x-s.x)*(i.y-t.y),o=(n.x-s.x)*(t.y-s.y)-(n.y-s.y)*(t.x-s.x),r=(i.x-t.x)*(t.y-s.y)-(i.y-t.y)*(t.x-s.x);if(0==a)return!1;var h=o/a,l=r/a;return h>=0%26%261>=h%26%26l>=0%26%261>=l}};var that=this,isIE=!!window.ActiveXObject,w=document.documentElement.clientWidth,h=document.documentElement.clientHeight,playerWidth=20,playerHeight=30,playerVerts=[[-1*playerHeight/2,-1*playerWidth/2],[-1*playerHeight/2,playerWidth/2],[playerHeight/2,0]],ignoredTypes=["HTML","HEAD","BODY","SCRIPT","TITLE","META","STYLE","LINK","SHAPE","LINE","GROUP","IMAGE","STROKE","FILL","SKEW","PATH","TEXTPATH"],hiddenTypes=["BR","HR"],FPS=50,acc=300,maxSpeed=600,rotSpeed=360,bulletSpeed=700,particleSpeed=400,timeBetweenFire=150,timeBetweenBlink=250,bulletRadius=2,maxParticles=isIE%3F20:40,maxBullets=isIE%3F10:20;this.flame={r:[],y:[]},this.toggleBlinkStyle=function(){this.updated.blink.isActive%3FremoveClass(document.body,"ASTEROIDSBLINK"):addClass(document.body,"ASTEROIDSBLINK"),this.updated.blink.isActive=!this.updated.blink.isActive},addStylesheet(".ASTEROIDSBLINK .ASTEROIDSYEAHENEMY","outline: 2px dotted red;"),this.pos=new Vector(100,100),this.lastPos=!1,this.vel=new Vector(0,0),this.dir=new Vector(0,1),this.keysPressed={},this.firedAt=!1,this.updated={enemies:!1,flame:(new Date).getTime(),blink:{time:0,isActive:!1}},this.scrollPos=new Vector(0,0),this.bullets=[],this.enemies=[],this.dying=[],this.totalEnemies=0,this.particles=[],updateEnemyIndex();var createFlames;with(function(){var e=playerWidth,t=.1*playerWidth,i=.6*playerWidth,s=.2*i,n=e/2,a=i/2,o=playerHeight/2;createFlames=function(){that.flame.r=[[-1*o,-1*n]],that.flame.y=[[-1*o,-1*a]];for(var r=0;e>r;r+=t)that.flame.r.push([-random(2,7)-o,r-n]);that.flame.r.push([-1*o,n]);for(var r=0;i>r;r+=s)that.flame.y.push([-random(2,7)-o,r-a]);that.flame.y.push([-1*o,a])}}(),createFlames(),this.gameContainer=document.createElement("div"),this.gameContainer.className="ASTEROIDSYEAH",document.body.appendChild(this.gameContainer),this.canvas=document.createElement("canvas"),this.canvas.setAttribute("width",w),this.canvas.setAttribute("height",h),this.canvas.className="ASTEROIDSYEAH",this.canvas.style)width=w+"px",height=h+"px",position="fixed",top="0px",left="0px",bottom="0px",right="0px",zIndex="10000";"undefined"!=typeof G_vmlCanvasManager%3F(this.canvas=G_vmlCanvasManager.initElement(this.canvas),this.canvas.getContext||alert("So... you are using IE%3F  Sorry but at the moment WebsiteAsteroids only supports Firefox")):this.canvas.getContext||alert("This program does not yet support your browser. Please join me at http://github.com/erkie/erkie.github.com if you think you can help"),addEvent(this.canvas,"mousedown",function(e){e=e||window.event;var t=document.createElement("span");t.style.position="absolute",t.style.border="1px solid %23999",t.style.background="white",t.style.color="black",t.innerHTML="Press Esc to quit",document.body.appendChild(t);var i=e.pageX||e.clientX+document.documentElement.scrollLeft,s=e.pageY||e.clientY+document.documentElement.scrollTop;t.style.left=i-t.offsetWidth/2+"px",t.style.top=s-t.offsetHeight/2+"px",setTimeout(function(){try{t.parentNode.removeChild(t)}catch(e){}},1e3)});var eventResize=function(){with(that.canvas.style.display="none",w=document.documentElement.clientWidth,h=document.documentElement.clientHeight,that.canvas.setAttribute("width",w),that.canvas.setAttribute("height",h),that.canvas.style)display="block",width=w+"px",height=h+"px"};if(addEvent(window,"resize",eventResize),this.gameContainer.appendChild(this.canvas),this.ctx=this.canvas.getContext("2d"),this.ctx.fillStyle="black",this.ctx.strokeStyle="black",document.getElementById("ASTEROIDS-NAVIGATION"))this.navigation=document.getElementById("ASTEROIDS-NAVIGATION"),this.points=document.getElementById("ASTEROIDS-POINTS");else{with(this.navigation=document.createElement("div"),this.navigation.id="ASTEROIDS-NAVIGATION",this.navigation.className="ASTEROIDSYEAH",this.navigation.style)fontFamily="Arial,sans-serif",position="fixed",zIndex="10001",bottom="10px",right="10px",textAlign="right";this.navigation.innerHTML="(press esc to quit) ",this.gameContainer.appendChild(this.navigation),this.points=document.createElement("span"),this.points.id="ASTEROIDS-POINTS",this.points.style.font="28pt Arial, sans-serif",this.points.style.fontWeight="bold",this.points.className="ASTEROIDSYEAH",this.navigation.appendChild(this.points)}if(setScore(),"undefined"!=typeof G_vmlCanvasManager)for(var c,children=this.canvas.getElementsByTagName("*"),i=0;c=children[i];i++)addClass(c,"ASTEROIDSYEAH");var eventKeydown=function(e){switch(e=e||window.event,that.keysPressed[e.keyCode]=!0,e.keyCode){case code(" "):that.firedAt=1}return-1!=indexOf([code("up"),code("down"),code("right"),code("left"),code(" "),code("B"),code("W"),code("A"),code("S"),code("D")],e.keyCode)%3F(e.preventDefault%26%26e.preventDefault(),e.stopPropagation%26%26e.stopPropagation(),e.returnValue=!1,e.cancelBubble=!0,!1):void 0};addEvent(document,"keydown",eventKeydown);var eventKeypress=function(e){return e=e||window.event,-1!=indexOf([code("up"),code("down"),code("right"),code("left"),code(" "),code("W"),code("A"),code("S"),code("D")],e.keyCode||e.which)%3F(e.preventDefault%26%26e.preventDefault(),e.stopPropagation%26%26e.stopPropagation(),e.returnValue=!1,e.cancelBubble=!0,!1):void 0};addEvent(document,"keypress",eventKeypress);var eventKeyup=function(e){return e=e||window.event,that.keysPressed[e.keyCode]=!1,-1!=indexOf([code("up"),code("down"),code("right"),code("left"),code(" "),code("B"),code("W"),code("A"),code("S"),code("D")],e.keyCode)%3F(e.preventDefault%26%26e.preventDefault(),e.stopPropagation%26%26e.stopPropagation(),e.returnValue=!1,e.cancelBubble=!0,!1):void 0};addEvent(document,"keyup",eventKeyup),this.ctx.clear=function(){this.clearRect(0,0,w,h)},this.ctx.clear(),this.ctx.drawLine=function(e,t,i,s){this.beginPath(),this.moveTo(e,t),this.lineTo(i,s),this.lineTo(i+1,s+1),this.closePath(),this.fill()},this.ctx.tracePoly=function(e){this.beginPath(),this.moveTo(e[0][0],e[0][1]);for(var t=1;t<e.length;t++)this.lineTo(e[t][0],e[t][1]);this.closePath()},this.ctx.drawPlayer=function(){this.save(),this.translate(that.pos.x,that.pos.y),this.rotate(that.dir.angle()),this.tracePoly(playerVerts),this.fillStyle="white",this.fill(),this.tracePoly(playerVerts),this.stroke(),this.restore()};var PI_SQ=2*Math.PI;this.ctx.drawBullets=function(e){for(var t=0;t<e.length;t++)this.beginPath(),this.arc(e[t].pos.x,e[t].pos.y,bulletRadius,0,PI_SQ,!0),this.closePath(),this.fill()};var randomParticleColor=function(){return["red","yellow"][random(0,1)]};this.ctx.drawParticles=function(e){for(var t=this.fillStyle,i=0;i<e.length;i++)this.fillStyle=randomParticleColor(),this.drawLine(e[i].pos.x,e[i].pos.y,e[i].pos.x-10*e[i].dir.x,e[i].pos.y-10*e[i].dir.y);this.fillStyle=t},this.ctx.drawFlames=function(e){this.save(),this.translate(that.pos.x,that.pos.y),this.rotate(that.dir.angle());var t=this.strokeStyle;this.strokeStyle="red",this.tracePoly(e.r),this.stroke(),this.strokeStyle="yellow",this.tracePoly(e.y),this.stroke(),this.strokeStyle=t,this.restore()},addParticles(this.pos),addClass(document.body,"ASTEROIDSYEAH");var isRunning=!0,lastUpdate=(new Date).getTime();this.update=function(){var e=!1,t=(new Date).getTime(),i=(t-lastUpdate)/1e3;lastUpdate=t;var s=!1;if(t-this.updated.flame>50%26%26(createFlames(),this.updated.flame=t),this.scrollPos.x=window.pageXOffset||document.documentElement.scrollLeft,this.scrollPos.y=window.pageYOffset||document.documentElement.scrollTop,this.keysPressed[code("up")]||this.keysPressed[code("W")]%3F(this.vel.add(this.dir.mulNew(acc*i)),s=!0):this.vel.mul(.96),(this.keysPressed[code("left")]||this.keysPressed[code("A")])%26%26(e=!0,this.dir.rotate(radians(rotSpeed*i*-1))),(this.keysPressed[code("right")]||this.keysPressed[code("D")])%26%26(e=!0,this.dir.rotate(radians(rotSpeed*i))),this.keysPressed[code(" ")]%26%26t-this.firedAt>timeBetweenFire%26%26(this.bullets.unshift({dir:this.dir.cp(),pos:this.pos.cp(),startVel:this.vel.cp(),cameAlive:t}),this.firedAt=t,this.bullets.length>maxBullets%26%26this.bullets.pop()),this.keysPressed[code("B")]%3F(this.updated.enemies||(updateEnemyIndex(),this.updated.enemies=!0),e=!0,this.updated.blink.time+=1e3*i,this.updated.blink.time>timeBetweenBlink%26%26(this.toggleBlinkStyle(),this.updated.blink.time=0)):this.updated.enemies=!1,this.keysPressed[code("esc")])return void destroy.apply(this);this.vel.len()>maxSpeed%26%26this.vel.setLength(maxSpeed),this.pos.add(this.vel.mulNew(i)),this.pos.x>w%3F(window.scrollTo(this.scrollPos.x+50,this.scrollPos.y),this.pos.x=0):this.pos.x<0%26%26(window.scrollTo(this.scrollPos.x-50,this.scrollPos.y),this.pos.x=w),this.pos.y>h%3F(window.scrollTo(this.scrollPos.x,this.scrollPos.y+.75*h),this.pos.y=0):this.pos.y<0%26%26(window.scrollTo(this.scrollPos.x,this.scrollPos.y-.75*h),this.pos.y=h);for(var n=this.bullets.length-1;n>=0;n--)if(t-this.bullets[n].cameAlive>2e3)this.bullets.splice(n,1),e=!0;else{var a=this.bullets[n].dir.setLengthNew(bulletSpeed*i).add(this.bullets[n].startVel.mulNew(i));this.bullets[n].pos.add(a),boundsCheck(this.bullets[n].pos);var o=getElementFromPoint(this.bullets[n].pos.x,this.bullets[n].pos.y);o%26%26o.tagName%26%26-1==indexOf(ignoredTypes,o.tagName.toUpperCase())%26%26hasOnlyTextualChildren(o)%26%26"ASTEROIDSYEAH"!=o.className%26%26(didKill=!0,addParticles(this.bullets[n].pos),this.dying.push(o),this.bullets.splice(n,1))}if(this.dying.length){for(var n=this.dying.length-1;n>=0;n--)try{this.dying[n].parentNode%26%26window.ASTEROIDS.enemiesKilled++,this.dying[n].parentNode.removeChild(this.dying[n])}catch(r){}setScore(),this.dying=[]}for(var n=this.particles.length-1;n>=0;n--)this.particles[n].pos.add(this.particles[n].dir.mulNew(particleSpeed*i*Math.random())),t-this.particles[n].cameAlive>1e3%26%26(this.particles.splice(n,1),e=!0);(e||0!=this.bullets.length||0!=this.particles.length||!this.pos.is(this.lastPos)||this.vel.len()>0)%26%26(this.ctx.clear(),this.ctx.drawPlayer(),s%26%26this.ctx.drawFlames(that.flame),this.bullets.length%26%26this.ctx.drawBullets(this.bullets),this.particles.length%26%26this.ctx.drawParticles(this.particles)),this.lastPos=this.pos,setTimeout(updateFunc,1e3/FPS)};var updateFunc=function(){that.update.call(that)};setTimeout(updateFunc,1e3/FPS)}if(window.ASTEROIDSPLAYERS||(window.ASTEROIDSPLAYERS=[]),window.ActiveXObject){try{var xamlScript=document.createElement("script");xamlScript.setAttribute("type","text/xaml"),xamlScript.textContent='<%3Fxml version="1.0"%3F><Canvas xmlns="http://schemas.microsoft.com/client/2007"></Canvas>',document.getElementsByTagName("head")[0].appendChild(xamlScript)}catch(e){}var script=document.createElement("script");script.setAttribute("type","text/javascript"),script.onreadystatechange=function(){("loaded"==script.readyState||"complete"==script.readyState)%26%26"undefined"!=typeof G_vmlCanvasManager%26%26(window.ASTEROIDSPLAYERS[window.ASTEROIDSPLAYERS.length]=new Asteroids)},script.src="http://erkie.github.com/excanvas.js",document.getElementsByTagName("head")[0].appendChild(script)}else window.ASTEROIDSPLAYERS[window.ASTEROIDSPLAYERS.length]=new Asteroids})()}();
